<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‚£è€…ç—‡çŠ¶ç¢ºèªè¡¨ - PsoriasisMed</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">PsoriasisMed</div>
            <nav>
                <ul>
                    <li><a href="index.html#hero">ãƒ›ãƒ¼ãƒ </a></li>
                    <li><a href="index.html#categories">æ²»ç™‚è–¬</a></li>
                    <li><a href="index.html#comparison">è–¬å‰¤æ¯”è¼ƒ</a></li>
                    <li><a href="index.html#search-by-condition">ç—‡çŠ¶ç¢ºèªè¡¨</a></li>
                    <li><a href="index.html#about">ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a></li>
                </ul>
            </nav>
            <div class="utility-nav">
                <a href="search.html" class="search-icon">æ¤œç´¢</a>
                <a href="favorites.html" class="favorite-icon">ãŠæ°—ã«å…¥ã‚Š</a>
            </div>
        </div>
    </header>

    <main>
        <section id="patient-profile-filters" class="search-filters-section">
            <div class="container">
                <h3>æ‚£è€…ç—‡çŠ¶ç¢ºèªè¡¨</h3>
                <p>æ‚£è€…æ§˜ã®ç—‡çŠ¶ã€é‡ç—‡åº¦ã€åˆä½µç—‡ã€æ—¢å¾€æ­´ãªã©ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€è©²å½“ã™ã‚‹æƒ…å ±ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>

                <div class="filter-group">
                    <h4>ç—‡çŠ¶</h4>
                    <div id="symptom-filters" class="filter-options"></div>
                </div>

                <div class="filter-group">
                    <h4>è©•ä¾¡æŒ‡æ¨™</h4>
                    <div id="evaluation-filters" class="filter-options"></div>
                </div>

                <div class="filter-group">
                    <h4>åˆä½µç—‡</h4>
                    <div id="comorbidity-filters" class="filter-options"></div>
                </div>

                <div class="filter-group">
                    <h4>å¢—æ‚ªãƒ»èª˜ç™ºå› å­</h4>
                    <div id="trigger-filters" class="filter-options"></div>
                </div>

                <button id="show-symptoms-button" class="button primary">æ¤œç´¢</button>
            </div>
        </section>

        <section id="symptom-results" class="search-results-section">
            <div class="container">
                <h4>ç¢ºèªçµæœ</h4>
                <div id="symptom-results-container"></div>
            </div>
        </section>
    <div class="container" style="text-align: center; margin-top: 40px;">
            <a href="index.html#hero" class="button primary">Topã¸æˆ»ã‚‹</a>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-columns">
                <div class="footer-logo">PsoriasisMed</div>
                <div class="footer-nav">
                    <h4>æ²»ç™‚è–¬</h4>
                    <ul>
                        <li><a href="biological_agents.html">ç”Ÿç‰©å­¦çš„è£½å‰¤</a></li>
                        <li><a href="oral_medications.html">å†…æœè–¬</a></li>
                        <li><a href="topical_medications.html">å¤–ç”¨è–¬</a></li>
                    </ul>
                </div>
                <div class="footer-nav">
                    <h4>æƒ…å ±</h4>
                    <ul>
                        <li><a href="search.html">è–¬å‰¤æ¤œç´¢</a></li>
                        <li><a href="index.html#comparison">æ¯”è¼ƒæ©Ÿèƒ½</a></li>
                        <li><a href="patient_symptom_checklist.html">æ‚£è€…ç—‡çŠ¶ç¢ºèªè¡¨</a></li>
                        <li><a href="how_to_use.html">ä½¿ã„æ–¹</a></li>
                        <li><a href="index.html#about">ã‚µã‚¤ãƒˆæƒ…å ±</a></li>
                        <li><a href="privacy_policy.html">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
                        <li><a href="terms_of_service.html">åˆ©ç”¨è¦ç´„</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>Â© 2024 PsoriasisMed. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="symptom_data.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize symptom checker page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded fired');
            console.log('symptomData:', typeof symptomData);
            
            // Direct initialization without function check
            if (typeof symptomData !== 'undefined') {
                console.log('symptomData available, initializing...');
                
                // Create checkboxes for each category
                createCheckboxes('symptom-filters', symptomData.ç—‡çŠ¶);
                createCheckboxes('evaluation-filters', symptomData.è©•ä¾¡æŒ‡æ¨™);
                createCheckboxes('comorbidity-filters', symptomData.åˆä½µç—‡);
                createCheckboxes('trigger-filters', symptomData["å¢—æ‚ªãƒ»èª˜ç™ºå› å­"]);
                
                // Add event listener to the show symptoms button
                const showSymptomsButton = document.getElementById('show-symptoms-button');
                if (showSymptomsButton) {
                    showSymptomsButton.addEventListener('click', displaySelectedSymptoms);
                    console.log('Event listener added to button');
                }
            } else {
                console.error('symptomData is not defined');
            }
        });
        
        // Create checkboxes function (inline to ensure it works)
        function createCheckboxes(containerId, dataArray) {
            console.log('Creating checkboxes for:', containerId, dataArray);
            const container = document.getElementById(containerId);
            if (!container || !dataArray) {
                console.error('Container or data not found:', containerId, dataArray);
                return;
            }
            
            container.innerHTML = ''; // Clear existing content
            
            dataArray.forEach((item, index) => {
                const checkboxDiv = document.createElement('div');
                checkboxDiv.classList.add('filter-checkbox');
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `${containerId}-${index}`;
                checkbox.value = typeof item === 'string' ? item : item.term;
                
                const label = document.createElement('label');
                label.htmlFor = checkbox.id;
                label.textContent = typeof item === 'string' ? item : item.term;
                
                checkboxDiv.appendChild(checkbox);
                checkboxDiv.appendChild(label);
                container.appendChild(checkboxDiv);
            });
            
            console.log('Checkboxes created for:', containerId, dataArray.length, 'items');
        }
        
        // Display selected symptoms function (inline)
        function displaySelectedSymptoms() {
            console.log('displaySelectedSymptoms called');
            const resultsContainer = document.getElementById('symptom-results-container');
            if (!resultsContainer) {
                console.error('Results container not found');
                return;
            }

            const getSelectedItems = (containerId) => {
                return Array.from(document.querySelectorAll(`#${containerId} input[type="checkbox"]:checked`))
                            .map(checkbox => checkbox.value);
            };

            const selectedSymptoms = getSelectedItems('symptom-filters');
            const selectedEvaluation = getSelectedItems('evaluation-filters');
            const selectedComorbidities = getSelectedItems('comorbidity-filters');
            const selectedTriggers = getSelectedItems('trigger-filters');

            console.log('Selected items:', {
                symptoms: selectedSymptoms,
                evaluation: selectedEvaluation,
                comorbidities: selectedComorbidities,
                triggers: selectedTriggers
            });

            let html = '';

            const appendDetails = (categoryName, selectedItems, dataCategory) => {
                if (selectedItems.length > 0) {
                    html += `<h4>${categoryName}</h4><ul>`;
                    selectedItems.forEach(selectedTerm => {
                        const item = dataCategory.find(d => (typeof d === 'string' ? d : d.term) === selectedTerm);
                        if (item) {
                            const displayText = typeof item === 'string' ? item : item.term;
                            const description = typeof item === 'object' && item.description ? item.description : '';
                            html += `<li>
                                <strong>${displayText}</strong>`;
                            if (description) {
                                html += `<small>${description}</small>`;
                            }
                            html += `</li>`;
                        }
                    });
                    html += `</ul>`;
                }
            };

            appendDetails('ç—‡çŠ¶', selectedSymptoms, symptomData.ç—‡çŠ¶);
            appendDetails('è©•ä¾¡æŒ‡æ¨™', selectedEvaluation, symptomData.è©•ä¾¡æŒ‡æ¨™);
            appendDetails('åˆä½µç—‡', selectedComorbidities, symptomData.åˆä½µç—‡);
            appendDetails('å¢—æ‚ªãƒ»èª˜ç™ºå› å­', selectedTriggers, symptomData["å¢—æ‚ªãƒ»èª˜ç™ºå› å­"]);

            if (selectedSymptoms.length === 0 && selectedEvaluation.length === 0 && selectedComorbidities.length === 0 && selectedTriggers.length === 0) {
                resultsContainer.innerHTML = '<p>ç¢ºèªã™ã‚‹é …ç›®ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>';
            } else {
                // Add summary at the top
                const totalItems = selectedSymptoms.length + selectedEvaluation.length + selectedComorbidities.length + selectedTriggers.length;
                const summaryHtml = `
                    <div style="background: linear-gradient(135deg, #007aff 0%, #0056b3 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; text-align: center;">
                        <h3 style="margin: 0 0 10px 0; font-size: 20px;">ğŸ“Š ç¢ºèªçµæœã‚µãƒãƒªãƒ¼</h3>
                        <p style="margin: 0; font-size: 16px; opacity: 0.9;">é¸æŠã•ã‚ŒãŸé …ç›®: <strong>${totalItems}ä»¶</strong></p>
                    </div>
                `;
                resultsContainer.innerHTML = summaryHtml + html;
                
                // Add animation effect
                resultsContainer.style.opacity = '0';
                resultsContainer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultsContainer.style.transition = 'all 0.5s ease';
                    resultsContainer.style.opacity = '1';
                    resultsContainer.style.transform = 'translateY(0)';
                }, 100);
            }
            
            // Scroll to results
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            console.log('Results updated');
        }
    </script>
</body>
</html>